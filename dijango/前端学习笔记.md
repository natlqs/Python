# **前端开发**

【【视频课：银角大王-武沛齐的B站教程：最新Python的web开发全家桶（django+前端+数据库）】】

——本视频是从整个系列的day10开始，前面9天是python教程

目的：开发一个平台

- 前端开发：HTML、CSS、JavaScript（BootStrap，jQuery）

- Web框架：接收请求并处理

- MySQL数据库：存储数据

快速上手：

​	基于Flask Web框架快速搭建一个网站出来

深入学习：

​	基于 Django 框架

# 1. Flask快速应用

```shell
pip install falsk
```

```python
# app.py
from flask import  Flask, render_template

app =  Flask(__name__)

# 创建了 网址/shouw/info 和 函数index的 对应关系
# 用户在浏览器上访问 /shouw/info，网站自动执行index函数
@app.route("/show/info")
def index():
    # Flask 会自动打开这个文件，读取内容返回给用户
    # 默认去当前项目目录的templates文件夹中找,并返回字符串
    return render_template("index.html")

if __name__ == '__main__':
    app.run()	# 端口可定义，参数：host、port

# day1
	# app.py
    #static
    	# img
    	# css
        # js
        # plugins
	# templates
    	# index.html
```

网站给浏览器返回本质：字符串。可以是简单的字符串，也可以是带html、css、js的。

Pycharm 更新 Flask 项目时要点 Rerun

先自己开发编写页面，开发完再集成到Flask框架中

在【HTML的form表单和案例】以及【MySQL的综合案例】中还有 Flask 的内容

# 2. HTML

HTML：超文本传输语言（与浏览器搭配）

HTML标签（默认格式样式，可以通过CSS等手段美化）

## 常用标签

```markdown
<meta charset="UTF-8">		// 浏览器编码方式
<title>页面标签</title>
<h1>标题，1~6级<h1>

<div>块级标签，占一行</div>
<span>内联标签，不占一整行</span>

# 行内标签
<a href="http://www.baidu.com/">超链接,点击跳转百度搜索</a>
<a href="/show/info">点击跳转到index.html</a>
<img scr="图片地址" />
<img style="height:100px; width:10%;" scr="/static/tp.png" />

<a href="" target="">
	<img src="" style=""/>
</a>

# 列表
<ul>
	<li>无序列表</li>
	<li>无序列表</li>
	<li>无序列表</li>
</ul>

<ul>
	<li>有序列表</li>
	<li>有序列表</li>
	<li>有序列表</li>
</ul>

# 表格
<table border="1">
	<thead>
		<tr>
			<th>ID</th>
			<th>头像</th>
			<th>姓名</th>
			<th>年龄</th>
			<th>更多信息</th>
			<th>操作</th>
		</tr>
	</thead>
	<tbody>
		<tr>
			<td>1</td>
			<td>
                <img src="/static/img/tx_1.png" alt="头像1" style=""/>
            </td>
			<td>张三</td>
			<td>14</td>
			<td>
                <a href="">查看详情</a>
            </td>
            <td>
            	编辑
            	删除
            </td>
		</tr>
		<tr>
			<td>2</td>
			<td>
                <img src="/static/img/tx_2.png" alt="头像2" style=""/>
            </td>
			<td>李四</td>
			<td>19</td>
            <td>
                <a href="">查看详情</a>
            </td>
            <td>
            	编辑
            	删除
            </td>
		</tr>
	</tbody>
</table>
```

| ID   | 头像    | 姓名 | 年龄 | 更多信息     | 操作       |
| ---- | ------- | ---- | ---- | ------------ | ---------- |
| 1    | [头像1] | 张三 | 14   | [查看详情]() | 编辑  删除 |
| 2    | [头像2] | 李四 | 19   | [查看详情]() | 编辑  删除 |

## input 标签

```markdown
<textarea rows="5">多行文本，可手动改大小</textarea>
<input type="text" name="">
<input type="textarea" name="">
<input type="password" name="">
<input type="file" name="">

# 单选框
<input type="radio" name="gender" value="1">男
<input type="radio" name="gender" value="2">女

# 复选框
<input type="checkbox" name="hobby" value="10">篮球
<input type="checkbox" name="hobby" value="20">足球
<input type="checkbox" name="hobby" value="30">棒球

<input type="button" value="提交">	// 普通按钮
<input type="submit" value="提交">	// 提交表单按钮

# 下拉列表
<select name="city">		// 加上mutiple属性可多选
	<option value="bj">北京</option>
	<option value="sh">上海</option>
	<option value="sz">深圳</option>		// 加上selected可预选值
</select>
```



## **网络请求GET/POST**

- 在浏览器的URL中写入地址，点击回车，访问。

  ```
  - 浏览器会发送数据过去，本质上发送的是字符串:
  - "GET /explore http1.1\r\nhost:. . . \r\nuser-agent\r\n..\r\n\r\n"
  
  - 浏览器会发送数据过去，本质上发送的是字符串:
  - "POsT /explore http1.1\rlnhost:.. .\r\nuser-agent\r\n..\r\n\\n数据库"
  ```

- 浏览器向后端发送请求时

  - GET请求【URL方法/表单提交】

    - 现象：GET请求、跳转、向后台传入数据数据会拼接在URL上

      ```
      https://www.baidu.com/s?ie=UTF-8&wd=安卓&name=xxx
      ```

  - POST请求【表单提交】

    - 现象：提交数据不在URL中体现，而是在请求体中

      ```
      https://gitee.com/login/
      ```

      

## form表单和提交

<img src="E:\Typora学习笔记\Typora图片路径\image-20220406form_notation.png" alt="image-20220406102048881" style="zoom: 67%;" />

```python
from flask import Flask, render_template, request

app = Flask(__name__)

@app.route('/register', methods=["GET"])
def register():
    return render_template('register.html')

@app.route("/get/reg", methods=["GET"])
def do_register():
    print(request.args)
    return "注册成功"

@app.route("/post/reg", methods=["POST"])	// 该路径只接受post提交方式
def post_register():
    print(request.form)
    return "注册成功"

if __name__ == '__main__':
    app.run()
```

```html
<h1>用户注册</h1>
<form action="/post/reg"method="post">
    用户名：<input type="text" name="user">
    密码：  <input type="password" name="pwd">
    <input type="submit" value="提交">
</form>
```

```markdown
// get方式
http://127.0.0.1:5000/get/reg?user=aaa&pwd=321	注册成功
127.0.0.1 - - [06/Apr/2022 10:26:20] "GET /get/reg?user=aaa&pwd=321 HTTP/1.1" 200 -
ImmutableMultiDict([('user', 'aaa'), ('pwd', '321')])


// post方式
http://127.0.0.1:5000/post/reg	注册成功

127.0.0.1 - - [06/Apr/2022 10:24:42] "POST /post/reg HTTP/1.1" 200 -
ImmutableMultiDict([('user', 'root'), ('pwd', '123')])
```

## 案例：注册页面form表单提交数据到后台

```python
// 只写后台部分，Flask框架
@app.route("/register", methods=["GET", "POST"])
def register():
    if request.method == "GET":
        return render_template('register.html')
    else:
        # 接受用户通过post发过来的数据
        user = request.form.get("user")					// text
        password = request.form.get("pwd")				// passowrd
        gender = request.form.get("gender")				// 单选框
        hobby_list = request.form.getlist("hobby")		// 复选框
        city = request.form.get("city")					// 下拉列表
        skill_list = request.form.getlist("skill")		// 下拉列表，可多选
        more = request.form.get("more")					// textarea

        # 将用户信息写入 文件、Excel、数据库中 实现注册
        
        # 再给用户返回结果
        return "注册成功"
```

## 标签简写

```
1.div.sidenav   ==>  <div class="sidenav"></div>
2.tr>td*5  ==>  tr里面包着5个td
```



# 3. CSS

CSS样式：专门用来”美化“标签

## **CSS链接方式**

- 在标签上，内联样式

  ```html
  <img src="" style="height:100px;">
  <div style="color:red;">中国联通</div>
  ```

- 在 head 标签中写 style 标签，内部样式

  ```html
  <head>
      <style>
          .c1{
              color:red;
          }
      </style>
  </head>
  <body>
  <h1 class='c1'>中国联通</h1>
  <h1 class='c1'>中国移动</h1>
  </body>
  ```

- 写到文件中，外部样式

  ```html
  <head>
      <link rel="stylesheet" href="/static/common.css">
  </head>
  <body>
  <h1 class='c1'>中国联通</h1>
  <h1 class='c1'>中国移动</h1>
  </body>
  ```

  ```css
  // common.css
  .c1{
      height:100px;
  }
  .c1{
      color:red;
  }
  ```

  多重样式优先级：内联 > 内部 > 外部 > 默认

## 选择器

- **id选择器**

  ```css
  #c1{
     
  }
  
  <div id='c1'></div>
  ```

- **类选择器（常用）**

  ```html
  .c1{
      
  }
  
  <div class='c1'></div>
  ```

- **标签选择器（常用）**

  ```html
  div{
      
  }
  
  <div>xxx</div>
  ```

  

- **属性选择器**

  ```html
  input[type='text']{
  	border: 1px solid red;
  }
  .v1[xx="999"]{
  	color: gold;
  }
  
  <input type="text">
  <div class="v1" xx="999">a</div>
  ```

- **后代选择器（常用）**

  ```html
  .yy li{
  	color: pink;
  }
  .yy > a{
  	color: red;
  }
  
  <div class="yy">
      <a>百度（红色）</a>
      <div>
          <a>谷歌</a>
      </div>
      <ul>
      	<li>中国</li>
          <li>美国</li>
          <li>日本</li>
      </ul>
  </div>
  ```

多样式&覆盖 问题

```html
.c1{
    color: red;	!import;	<!-- 表示不会被覆盖-->
    border: 1px solid red;
}
.c1{
	font-size: 28px;
    color: green;
}

<div class="c2 c1">不重名则一起应用，重名则按定义顺序（不是class中顺序），下面的覆盖上面的</div>
```





## height、width

```html
.c1{
	height: 300px;
	width: 50%;
}
```

注意事项：

- 宽度，支持百分比
- 行内标签默认无效
- 块级标签默认有效，但即使留出空白也不给占用

## display

```css
display:hidden;			- 隐藏 --> 隐藏但占用空间
display: none;			- 隐藏 --> 隐藏且不占用空间
display: inline;		- 块级 --> 行内
display: block;			- 行内 --> 块级
display: inline-block;	- 块/行--> 行内&块级，内联样式
```

## font(字体)

```css
.c1{
	color: #00FF7F;		// 颜色
    font-size: 18px;	// 大小
    font-weight: 600;	// 加粗
    font-family: Microsoft Yahei;	// 字体格式
    text-decoration: none;	// 字体取消下划线
}
```

## 文字对齐

```
.c1{
	text-align: center;		// 水平居中
	line-height: ..px;		// 垂直居中，值为区域的高度
}
```

## float(浮动)

```html
<div>
    <span>左边</span>
    <span style="float: right">右边</span>
</div>
```

块级标签浮动起来就没那么霸道，自己有多宽占多宽，不占一整行

标签浮动起来后会脱离文档流（飘起来，会覆盖其他标签，而且无法将父标签撑起来[孩子多高，父亲多高]）

解决方法1：可以在最后一个孩子中用 【clear属性】把它拽回来（清除浮动），从而撑起父亲

```html
<div style="background-color: dodgerblue">
	<div class="item"></div>
	<div class="item"></div>
    <div class="item"></div>
    <div class="item"></div>
    <div class="item"></div>
	<div style="clear: both; "></div>	// clear:  某侧不允许浮动，both两侧，none允许（默认值），left、right
</div>
```

解决方法2：用 after 伪类加在尾部↓↓↓



## hover&after（伪类）

hover：鼠标悬停效果，当鼠标移动到 下载APP上时，跳出hover_mi.png图像

```html
.download{
	display: none;
}
.app:hover .download{
	display: block;
}

<div class="app">
    <div class="title">下载app</div>
    <div class="download">
        <img src="images/hover_mi.png" alt="">
    </div>
</div>
```

after：找到对应的类，在每个标签后边加上点东西。

```html
.c1:after{
	content: "，欢迎你！"
}

<body>
    <div class="c1">用户1</div>
    <div class="c1">用户2</div>
</body>

<!-- 
显示效果：
用户1，欢迎你！
用户2，欢迎你！
-->
```

```css
<!-- 可以用来清除浮动,撑起父亲 -->
.clearfix:after{
	content: "";
	display: block;
	clear: both;
}
.item{
	float: left;
}
 <body>
     <div class="clearfix">
         <div class="item">1</div>
         <div class="item">2</div>
         <div class="item">3</div>
     </div>
</body>
```



## 盒子模型(内外边距)

**外边距margin**

**边框border**

**内边距padding**

**内容content**

body 标签默认有个小边距（白色间隙），无法铺满网页。需要修改margin值为0

```
body{
	margin: 0;
}
```

**鼠标移上去会加边框**，实质是原先有透明色，移上后没了

```css
.c1{
	border: 2px solid red transparent;
}
.c1:hover{
	border: 2px solid red;
}
```

构建一个显示在浏览器**居中的div**

```css
.c1{
	width: 980px;
	height: 900px;
	background-color: pink;
	margin: 0 auto;		// 整个区域居中
}
<div class="c1"></div>
```

## 布局

（B站有专门的课）把看到的页面划分成很多小区域，再去填充样式

- div标签 划分区域
- 搭建骨架
- 分块编写





## position(定位)

**1. fixed**：相对浏览器窗口位置 绝对固定（页面右侧固定导航栏，对话框）

```css
.back{
    position: fixed;
    width: 60px;
    height: 400px;
    border: 1px solid red;

    right: 0;
    top: 200px;
}

<div class="back"></div>
```

**2. relative和absolute**

父元素relative，子元素absolute，子元素可以相对父元素改变位置

```html
.c1{
	height: 300px;
	width: 500px;
	border: 1px solid red;
	margin: 100px;

	position:relative;
}
.c1 .c2{
	height: 59px;
	width: 59px;
	background-color: #00FF7F;
	
	position: absolute;
	right: 0;
	top: 0;
}

<div class="c1">
    <div class="c2"></div>
</div>
```

## 案例：对话框原理

用到的是position的fixed

```css
body{
    margin: 0;
}
.dialog{
    position: fixed;
    height: 300px;
    width: 500px;
    background-color: white;

  /*对话框居中方法1：左边50%再往回走一半的宽度
    left: 50%;     	
    margin-left: -250px; */

    left: 0;
    right: 0;
    margin: 0 auto;
    top: 200px;

    z-index: 1000;
}
.mask{
    position: fixed;
    background-color: black;
    left: 0;
    right: 0;
    top: 0;
    bottom: 0;
    opacity:0.7;

    z-index: 999;
}

<!-- 弹出对话框界面一共套了三层，页面底层，透明度幕布中层，对话框上层
     可以用 z-index 设置元素的堆叠顺序，越大的在上层
-->
<div style="height: 1000px;"></div>
<div class="mask"></div>
<div class="dialog">对话框</div>
```



## 案例：鼠标悬停 显示图片

用到的是position的relative和absolute

```html
.app{
	position:relative;
}
.app .download{
	position:absolute;
	height: 100px;
	width: 100px;
	display: none;
}
.app:hover .download{
	display: block;
}

<a href="" class="app">下载APP
	<div class="download">
		<img src="images/hover_mi.png" alt="">
	</div>
</a>
```







## 案例：多级菜单-小米首页

实现效果：

<img src="E:\Typora学习笔记\Typora图片路径\image-20220406230949257.png" alt="image-20220406230949257" style="zoom: 50%;" />

**小结**

- 垂直方向居中

  - 文本 + line-height
  - 图片 + 边距

- a 标签是**行内标签**，**高度和内外边距默认无效**。可以把他们设置为内联样式

  ```css
  display: inline-block;
  ```

- a 标签默认有下划线，可以去除

  ```css
  text-decoration: none; 
  ```

- 鼠标放上去后改变样式，用hover

  ```css
  a:hover{
  	color: white;
  }
  ```

- 设置透明度

  ```css
  opacity: 0.5	/* 0~1 透~不透 */
  ```

- 对于浮动的div，其孩子div的最后一个要拽回来撑起父亲，即清除浮动

  ```html
  <div style="clear:both"></div>
  ```

- 相同的样式可以设一个属性写在一起，用到的标签都引用那个属性

  ```css
  .left{
  	float: left;
  }
  ```

- 设置img的宽高CSS样式为100%，在具体图片的父元素中设置长宽就能对应修改图片

  ```css
  img{
      wigth: 100%;
      height: 100%;
  }
  .news .list-item{
      width: 316px;
      height: 170px;
  }
  <div class="news">
  	<div class="list-item" >
      	<img src="">
  	</div>
  </div>
  ```

项目代码：

```html
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <style>
        body{
            margin: 0;
        }
        img{
            wigth: 100%;
            height: 100%;
        }
        .left{
            float: left;
        }
        .container{
            width: 1243px;
            margin: 0 auto;
        }

        .header{
            background: #333;
        }
        .header .menu{
            float: left;
            color: white;
        }
        .header .account{
            float: right;
            color: white;
        }
        .header a{
            color: #b0b0b0;
            line-height: 40px;
            display: inline-block;
            font-size: 12px;
            margin-right: 10px;
            text-decoration: none;
        }
        .header a:hover{
            color: white;
        }
    
        .sub-header{
            height: 100px;
        }
        .sun-header ht{     /* 统一设置高度 */
            height: 100px;
        }
        .sub-header .logo{
            width: 234px;
            float: left;
        }
        .sub-header .logo a{
            margin-top:22px;      /* (100-56)/2=22 */
            display:inline-block;
        }
        .sub-header .logo a img{
            height:56px;
            width:56px;
        }
        .sub-header .menu-list{
            float: left;
            line-height: 100px;
        }
        .sub-header .menu-list a{
            display: inline-block;
            padding: 0px 20px;
            color: #333;
            font-size: 16px;
            text-decoration: none;
        }
        .sub-header .menu-list a:hover{
            color: #ff6700;
        }
        .sub-header .search{
            float: right;
        }
    
        .slider .sd-img{
            wigth:1226px;
            height: 460px;
        }
    
        .news{
            margin-top: 14px;
        }
        .news .channel{
            width: 228px;
            height: 164px;
            background-color: #5f5750;
            padding: 3px;
        }
        .news .channel .item{
            height: 82px;
            width: 76px;
            float: left;
            text-align: center;
        }
        .news .channel .item a{
            display: inline-block;
            font-size: 12px;
            padding-top: 18px;
            color: #fff;
            text-decoration: none;
            opacity: 0.7;
        }
        .news .channel .item a:hover{
            opacity: 1;;
        }
        .news .channel .item img{
            height: 24px;
            width: 24px;
            display: block;
            margin: 0 auto 4px;
        }
        .news .list-item{
            width: 316px;
            height: 170px;
            float: left;
        }
    </style>
</head>
<body>

<div class="header">
    <div class="container">
        <div class="menu">
            <a href="">小米商城</a>
            <a href="">MIUI</a>
            <a href="">loT</a>
            <a href="">云服务</a>
            <a href="">天星数科</a>
            <a href="">有品</a>
            <a href="">小爱开放平台</a>
        </div>
        <div class="account">
            <a href="">登录</a>
            <a href="">注册</a>
            <a href="">消息通知</a>
        </div>
        <div style="clear:both"></div>
    </div>
</div>

<div class="sub-header">
    <div class="container">
            <div class="ht logo">
                <a href="https://www.mi.com/" >
                    <img src="images/logo-mi2.png" alt="logo-mi2.png图片">
                </a>
            </div>
        <div class="ht menu-list">
            <a href="">Xiaomi手机</a>
            <a href="">Redmi红米</a>
            <a href="">电视</a>
            <a href="">笔记本</a>
            <a href="">平板</a>
        </div>
        <div class="ht search" style="clear:both;"></div>
    </div>
</div>

<div class="slider">
    <div class="container">
        <div class="sd-img">
            <img src="images/b1.png" alt="">
        </div>
    </div>
</div>

<div class="news">
    <div class="container" >
        <div class="channel left">
            <div class="item">
                <a href="">
                    <img src="images/d1.png" alt="">
                    <span>保障服务</span>
                </a>
            </div>
            <div class="item">
                <a href="">
                    <img src="images/d2.png" alt="">
                    <span>企业团购</span>
                </a>
            </div>
            <div class="item">
                <a href="">
                    <img src="images/d3.png" alt="">
                    <span>F码通道</span>
                </a>
            </div>
            <div class="item">
                <a href="">
                    <img src="images/d4.png" alt="">
                    <span>米粉卡</span>
                </a>
            </div>
            <div class="item">
                <a href="">
                    <img src="images/d5.png" alt="">
                    <span>以旧换新</span>
                </a>
            </div>
            <div class="item">
                <a href="">
                    <img src="images/d6.png" alt="">
                    <span>话费充值</span>
                </a>
            </div>
            <div style="clear:both"></div>
        </div>
        <div class="list-item left" style="margin-left: 14px">
            <img src="images/c1.jpg">
        </div>
        <div class="list-item left" style="margin-left: 15px">
            <img src="images/c2.jpg">
        </div>
        <div class="list-item left" style="margin-left: 15px">
            <img src="images/c3.jpg">
        </div>
        <div style="clear:both"></div>
    </div>
</div>

</body>
</html>
```



## CSS项目常用样式汇总

```css
background	// 设置背景
color		// 设置字体颜色
background-color	// 设置背景颜色
opacity		// 设置透明度
z-index		// 元素堆叠顺序

width		// 设置宽度
height		// 设置高度

font-size	// 设置字体大小
color		// 设置字体颜色
text-align: center;	// 字体水平居中
line-height	// 字体垂直居中
text-decoration		// 字体去除下划线

margin		// 外边距
padding		// 内边距

display		// inline-block设为内联样式，none为隐藏
float		// 设置浮动
style="clear:both"	// 清除浮动

:hover{}	// 鼠标悬停
:after{}	// 在元素最后附加内容，常用来清除浮动
```



# 4. BootStrap

别人已经写好的CSS，通过class引入就行。使用方法：

- 下载BootStrap: https://v3.bootcss.com/，下载用于生产环境的BootStrap
- 使用
  - 在页面引入BootStrap
  - 在编写HTML时，按照BootStrap的规定来写 + 自定制

## <link BootStrap .>

```markdown
// 开发版本，css容易查看，开发的时候用这个
<link rel="stylesheet" href="static/plugins/bootstrap-3.4.1/css/bootstrap.css">

// 生产版本，容积压缩了，上线的时候用这个
<link rel="stylesheet" href="static/plugins/bootstrap-3.4.1/css/bootstrap.min.css">
```

- 打开官网文档：https://v3.bootcss.com/css/ 打开顶部 组件 菜单，找到想要的功能

- ctrl+shift+c 点击需要的区域，右键 -->  Copy outerHTML 粘贴到项目中

- 然后Pycharm点击code-->Reformat Code进行格式化一下（ctrl+shift+alt+L）
- 执行html查看页面，F12进行调整，自己在style标签中按自己需求修改对应的效果

## container 布局容器

```html
<!-- .container 类用于固定宽度并支持响应式布局的容器。 -->
<div class="container">
    <div class="col-sm-9">左边</div>
    <div class="col-sm-3">右边</div>
</div>
```

```html
<!-- .container-fluid 类用于 100% 宽度，占据全部视口（viewport）的容器。(铺满整行) -->
<div class="container-fluid">
    <div class="col-sm-9">左边</div>
    <div class="col-sm-3">右边</div>
</div>
```

## 栅格系统

必须包含在布局容器中，把一行划分成12格

分类

- 响应式，刚开始是堆叠在一起，当浏览器页面宽度大于一定像素时才生效

  ```
  .col-lg-	> 1170px时
  .col-md-	> 970px 时，适合桌面显示器
  .col-sm-	> 750px 时，适合平板
  ```

- 非响应式

  ```html
  .col-xs-	总是水平排列
  
   <div class="col-xs-2" style="background-color: red;">条1</div>
   <div class="col-xs-8" style="background-color: green;">条2</div>
  
  ```

- 列偏移

  ```html
   <div class="col-md-offset-4 col-sm-4	" style="background-color: gred;">长4格，列偏移向右4格</div>
  ```

  

## 图标

- bootstrap 图标
- fontawesome组件    https://fontawesome.dashgame.com/  存在plugins中

## BootStrap依赖

BootStrap的事件依赖JavaScrip的类库：jQuery

- 下载 jQuery 在页面上应用   https://code.jquery.com/jquery-3.6.0.min.js

- 在页面上应用BootStrap 的JavaScrip类库

  ```html
  <script src="static/js/jquery-3.6.0.min.js"></script>
  <script src="static/plugins/bootstrap-3.4.1/js/bootstrap.min.js"></script>
  ```

  

## --案例：博客主页

实现要求：

<img src="E:\Typora学习笔记\Typora图片路径\image-20220407150146000.png" alt="image-20220407150146000" style="zoom:67%;" />

去BootStrap官网，先分配好栅格布局，然后分别添加组件

```html
<div>导航栏</div>
<div class="container-fluid clearfix">
    <div class="col-sm-9">
    	媒体对象*2
        分页
    </div>
    <div class="col-sm-3">
    	面板
        面板
    </div>
</div>
```

实现效果：

![image-20220407155740987](E:\Typora学习笔记\Typora图片路径\image-20220407155740987.png)



## --案例：登录界面

步骤：

- div 做一个登录框
- 框居中，标题居中，加入登录组件
- 调整登录框外边距、圆角、阴影效果，调整登录组件内边距

实现效果：

<img src="E:\Typora学习笔记\Typora图片路径\image-20220407170151981.png" alt="image-20220407170151981" style="zoom: 33%;" />

代码：

```html
.account{
    width: 400px;
    height: 300px;
    border: 1px solid #dddddd;
    border-radius: 5px;
    box-shadow: 3px 3px 20px #aaa;

    margin-left: auto;
    margin-right: auto;
    margin-top: 150px;
    padding: 20px 40px;
}
.account  h2{
    text-align: center;
    margin-top: 10px;
}

<div class="account">
    <h2>用户登录</h2>
    <form>
        <div class="form-group">
            <label for="exampleInputUsername">用户名</label>
            <input type="username" class="form-control" id="exampleInputUsername" placeholder="Username">
        </div>
        <div class="form-group">
            <label for="exampleInputPassword1">密码</label>
            <input type="password" class="form-control" id="exampleInputPassword1" placeholder="Password">
        </div>

        <button type="submit" class="btn btn-primary">登 录</button>
    </form>
</div>
```



## --案例：后台管理界面

步骤

- 导航栏+一个container
- container：
  -  面板1：含内联表单
  - 面板2：含表格，操作列是两个按钮
  - 一个分页组件

- 字的前面添加图标

实现效果：

<img src="E:\Typora学习笔记\Typora图片路径\image-20220407182335957.png" alt="image-20220407182335957" style="zoom:50%;" />

代码：

```html
<!--  区域1：顶部导航栏  -->
<div class="navbar navbar-default" style="border-radius: 0;">
    <div class="container">
        <div class="navbar-header">
            <button aria-expanded="false" class="navbar-toggle collapsed" data-target="#bs-example-navbar-collapse-1"
                    data-toggle="collapse" type="button">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="#">学生信息</a>
        </div>
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav">
                <li><a href="#">校区1</a></li>
                <li><a href="#">校区2</a></li>
            </ul>
            <ul class="nav navbar-nav navbar-right">
                <li><a href="#">登录</a></li>
                <li><a href="#">注册</a></li>
            </ul>
        </div>
    </div><!-- /.container-fluid -->
</div>

<!-- 区域2：container容器 -->
<div class="container">
    <!--  面板1：表单区域  -->
    <div class="panel panel-default">
        <div class="panel-heading">
            <span class="glyphicon glyphicon-edit" aria-hidden="true"></span> 表单区域
        </div>
        <div class="panel-body">
            <form class="form-inline">
                <div class="form-group">
                    <input type="text" class="form-control" id="formInputName" placeholder="姓名">
                </div>
                <div class="form-group">
                    <input type="text" class="form-control" id="formInputSno" placeholder="学号">
                </div>
                <div class="form-group">
                    <input type="text" class="form-control" id="formInputMajor" placeholder="专业">
                </div>
                <button type="submit" class="btn btn-success">
                    <span class="glyphicon glyphicon-plus-sign" aria-hidden="true"></span> 添加
                </button>
            </form>
        </div>
    </div>
    <!--  面板2：数据列表  -->
    <div class="panel panel-default">
        <div class="panel-heading">
            <span class="glyphicon glyphicon-th-list" aria-hidden="true"></span> 数据列表
        </div>
        <div class="panel-body">
            以下是学生信息数据：
        </div>
        <table class="table table-bordered table-hover">
            <thead>
            <tr>
                <th>#</th>
                <th>姓名</th>
                <th>学号</th>
                <th>专业</th>
                <th>操作</th>
            </tr>
            </thead>
            <tbody>
            <tr>
                <th scope="row">1</th>
                <td>张三</td>
                <td>001</td>
                <td>计算机</td>
                <td>
                    <a type="button" class="btn btn-primary btn-xs">编辑</a>
                    <a type="button" class="btn btn-danger btn-xs">删除</a>
                </td>
            </tr>
            <tr>
                <th scope="row">2</th>
                <td>李四</td>
                <td>003</td>
                <td>软件工程</td>
                <td>
                    <a type="button" class="btn btn-primary btn-xs">编辑</a>
                    <a type="button" class="btn btn-danger btn-xs">删除</a>
                </td>
            </tr>
            <tr>
                <th scope="row">3</th>
                <td>王五</td>
                <td>012</td>
                <td>大数据</td>
                <td>
                    <a type="button" class="btn btn-primary btn-xs" >编辑</a>
                    <a type="button" class="btn btn-danger btn-xs">删除</a>
                </td>
            </tr>
            </tbody>
        </table>

    </div>
    <!--  分页  -->
    <ul class="pagination">
            <li class="disabled"><a href="#" aria-label="Previous"><span aria-hidden="true">«</span></a></li>
            <li class="active"><a href="#">1 <span class="sr-only">(current)</span></a></li>
            <li><a href="#">2</a></li>
            <li><a href="#">3</a></li>
            <li><a href="#">4</a></li>
            <li><a href="#">5</a></li>
            <li><a href="#" aria-label="Next"><span aria-hidden="true">»</span></a></li>
        </ul>
</div>
```



# 5. JavaScript

 用处：让程序实现一些动态的效果

## **存放位置**

- head 标签的尾部 ×

  > 不推荐，放在前面会先加载 js 再加载 html 显示页面，如果js操作比较耗时，页面会卡住，得等一段时间才能加载出页面
  >
  > 如果要先呈现某些事件再显示页面，那么要放在前面（很少）

- body 标签的尾部 √

  > 推荐，先显示出页面，再慢慢加载 js 事件

```html
<script style="text/javascript">
    // 编写javascript代码
</script>
```

- 写在js文件中，html 导入(可能会引入别的网站的js，放在body尾部更好)

```html
<script src="static/my.js"></script>
```

初识js：

```html
<style>
		.menu{
		width: 200px;
		border: 1px solid red;
	}
	.menu .header{
		background-color: gold;
		padding: 20px 10px;
}
</style>

<body>
    <div class="menu">
        <div class="header" onclick="myFunc()">大标题</div>
        <div class="item">内容</div>
    </div>

    <script style="text/javascript">
        function myFunc(){
            var name="张三";
          	console.log(name);
        }
    </script>
</body>
```



## 字符串类型

```js
// 声明
var name = "张三";
var name = String("张三");

// 常见功能
var name = "中国联通";

var v1 = name.length;
var v2 = name[0];		// name.charAt(0);
var v3 = name.trim();	// 去除空白
var v4 = name.substring(1,2);	// 切片，前取后不取


```

## **--案例：跑马灯**

```javascript
<span id="txt">欢迎各位老师出席会议！</span>

function show(){
    // 1. 去HTMl中找到某个标签并获取他的内容（DOM）
    var tag = document.getElementById("txt");
    var dataString = tag.innerText;

    // 2. 动态起来，把文本中的第一个字符放在字符串的最后
    var firstString = dataString[0];
    var otherString = dataString.substring(1, dataString.length);
    var newText = otherString + firstString;

    // 3. 在HTML标签中更新内容
    tag.innerText = newText;
}

// JavaScript中的定时器，如：每1s执行一次show函数
setInterval(show, 1000);

```

## 数组

```js
// 定义
var v1 = [11,22,33,44];
var v2 = Array([11,22,33,44]);

// 操作
var v1 = [11,22,33,44];

v1[1];
v1[0] = "张三";

v1.push("李四");		// 尾部追加
v1.unshift("王五")	// 头部追加
v1.splice(1,0,"中国");// 指定插入，v1.splice(索引,0,元素)

v1.pop()		// 尾部删除
v1.shift()		// 头部删除
v1.splice(2,1)		// 指定删除，v1.splice(索引,1)

for(var idx in v1){
    // idx 为索引值
    data = v1[idx];
}

for(var i=0; i<v1.length; i++){
    // break和continue可用
}
```

## **--案例：动态数据**

```markdown
<ul id="city"> </ul>

var cityList = ["北京","上海","深圳"];

for(var idx in cityList){
    // 发送网络请求，获取数据
    var text = cityList[idx];
    // 创建标签
    var tag = document.createElement("li");
    // 写入内容
    tag.innerText = text;
    // 添加到id的对应标签里(DOM)
    var parentTag = document.getElementById("city");
    parentTag.appendChild(tag);
}
```

## 字典

```js
info = {				info = {
    "name":"张三",		   name:"张三",
    "age":18				age:18
}						}


info.age				info["age"]
info.name = "李四"	   info["name"] = "李四"

delete info["age"]
```

```js
info = {
    name:"张三",
    age:18
}

for(var key in info){
    // key=name+age
    data = info[key]
}
```

## --案例：动态表格

```html
<table border="1">
        <thead>
            <tr>
                <th>ID</th>
                <th>name</th>
                <th>age</th>
            </tr>
        </thead>
        <tbody id="body">

        </tbody>
    </table>
```

```js
// 从网络请求数据获取，写入到页面上
var dataList = [
    {id:1,name:"张三",age:19},
    {id:2,name:"李四",age:14},
    {id:3,name:"王五",age:16},
]

for(var idx in dataList){
    var info = dataList[idx];
    var tr = document.createElement("tr");
    for(var key in info){
        var text = info[key];
        var td = document.createElement("td");
        td.innerText = text;
        tr.appendChild(td);
    }
    var bodyTag = document.getElementById("body");
    body.appendChild(tr);
}
```

## 条件语句

```js
if(条件){
    // 语句1
}else if(条件){
    // 语句2
}else{
    // 语句3
}
```

## 函数

```js
function func(){
    ...
}
    
func()
```

## DOM

DOM就是一个模块，可以**对HTML页面中的标签进行操作**

DOM可以实现很多功能，但是比较繁琐

页面上的效果：jQuery来实现 / vue.js / react.js

```js
// 根据ID获取标签
var tag = document.getElementById("idName");

// 获取标签中的文本
tag.innerText;

// 修改标签中的文本
tag.innetText = "哈哈哈";

// 创建标签并写入
var tag = document.createElement("div");
tag.innerText = "哈哈哈";

```

## --事件的绑定

```js
/* 添加文本框输入的内容到列表中 */

<input type="text"  id="txtUser" placeholder="请输入内容">
<input type="button" value="点击添加" onclick="addCityInfo()">
<ul id="city">

</ul>

function addCityInfo(){

    // 1. 找到输入框的标签
    var txtTag = document.getElementById("txtUser");

    // 2. 获取用户输入的内容
    var newString = txtTag.value;

    // 3. 判断用户输入是否为空，不为空才继续
    if(newString.length > 0){

    // 创建标签，li标签中写入用户输入的内容
    var newTag = document.createElement("li");
    newTag.innerText = newString;
    // li添加到ul中
    var parentTag = document.getElementById("city");
    parentTag.appendChild(newTag);
    //  将输入框内容清空
    txtTag.value = "";
        
    }else{
    alert("输入不能为空");
    }
}
```

# Python知识总结（后面贴进去）

## 编码相关知识

文件存储时使用某种编码，打开时也要用相同的编码，否则会乱码

字符底层存储时本质上都是010101010101

**字符和二进制对应关系（编码）：**

		- ascii编码，256个对应字符
		- gb2312 --> gbk：包含中文和亚洲一些国家的文字【一个汉字占2字节】
		- unicode：ucs2/ucs4，包括现有所有文明
		- utf-8编码【一个汉字占3字节】

```python
data = "中"
res = data.encode('utf-8')
print(res)	# b'\xe4\xb8\xad'

data = "国"
res = data.encode('gbk')
print(res)	# b'\xb9\xfa'
```

**Python默认解释器编码(utf-8)**

​		python.exe	代码文件

如果将代码文件保存成了gbk编码，将Python模式解释器编码修改成gbk

## 字符串格式化

```python
v1 = "我是{}, 今年{}".format("张三", 21)	# 推荐

v2 = "我是%s, 今年%d岁" %("张三", 21)

name = "张三"
age = 21
v3 = f"我是{name}, 今年{age}岁“
```

## 数据类型

```
常见数据类型：int、bool、str、list、tuple、dict、set、float、None
	- 哪些转换成布尔值为False：空、None、0
	- 可变和不可变划分，可变的有：list、set、dict
	- 可哈希和不可哈希，不可哈希的有：list、set、dict
	- 字典的键/集合的元素，必须是可哈希的类型（list、set、dict不能做字典的键和集合元素）
	
主要数据类型：
	- str
		- 独有功能：upper/lower/startswith/split/strip/join...
		  注意：str不可变，不会对原字符串进行修改，而是生成新的内容
		- 公共功能：len/索引/切片/for循环/判断是否包含
	- list
		- 独有功能：append/insert/remove/pop...
		  注意：list可变，功能很多都是对原数据操作
		- 公共功能：len/索引/切片/for循环/判断是否包含
	- dict
		- 独有功能：get/keys/items/values...
		- 公共功能：len/索引/for循环/判断是否包含（判断键效率很高）
```

## and和or的运算逻辑

```markdown
特殊的逻辑运算（整体结果取决于谁？）
	v1 = 99 and 88		# 88
	v2 = [] or 10		# 10
	v3 = "联通" or []    # "联通"
	
True and ?  对于and运算，前面为true，结果取决于后面
False or ?	对于or运算，前面为True则结果就是前面的；若前面为False，结果取决于后面，后面True则结果为True
```

## 列表推导式

```python
data = []
for i in range(10):
	data.append(i)
    
// 简化写法
v1 = [ i for i in range(10) ]

v1 = [ i for i in range(10) if i<5]		# [0,1,2,3,4]
```

## 函数编程

```
函数基础知识：
	- 定义
	- 参数，概念：位置传参/关键字传参/参数默认值/动态参数*args，**kwargs
	- 返回值
		- 函数中一旦遇到return就立即返回，后续代码不再执行
		- 函数没有返回值则默认返回None
函数进阶知识：
	- Python中是以函数为作用域
	- 全局变量和局部变量，规范：全局变量（大写），局部变脸（小写）
	- 在局部变量中可以使用globa关键字，作用：引用全局的那个变量而非当作局部变量使用
	
内置函数（python内部提供的函数）：
	- bin/hex/odc/max/min/divmod/sorted/open文件操作
	
文件操作：
	- 基本操作：打开、操作、关闭，为了防止忘记关闭文件，可以怎么做？with
	- 打开文件时的模式：
		- r/rb，读		   【文件不存在，报错】		【文件夹不存在，报错】
		- w/wb，写（清空）	【文件不存在，自动新建】	【文件夹不存在，报错】
		- a/ab，追加		  【文件不存在，自动新建】	  【文件夹不存在，报错】
	  注意：os.markedirs/os.path.exsits、判断是否存在，不存在新建目录
```

## 模块

```mar
模块的分类：
	- 自定义模块：
		- os.path，导入模块时python内部都回去那个目录找
		- 自己写py文件时，不要与python内置模块同名
		- import、from xx import xx
	
	- 内置模块：time/datetime/json/re/random/os...
	
	-第三方模块：requests、openpyxl、python-docx、flask、bs4


查看当前目录下所有的文件（一级目录/所有目录）：os.listdir / os.walk
关于时间模块：时间戳 / datetime格式 / 字符串， 三种时间格式可以相互转换
关于JSON模块：
	- JSON本质是字符串，有一些自己格式的要求，例如：无元组/无单引号
	- json.dumps序列化时，只能序列化Python常用数据类型:
		+———————————————————————+
		|Python		|JSON		|
		+===========+===========+
		|dict		|object		|
		+———————————+———————————+
		|list,tuple	|array		|
		+———————————+———————————+
		|str		|strijg		|
		+———————————+———————————+
		|int,float	|JSONnumber	|
		+———————————+———————————+
		|True		|true		|
		+———————————+———————————+
		|False		|false		|
		+———————————+———————————+
		|None		|null		|
		+———————————+———————————+

关于re正则模块：
	- 正则： \d  \w
	- 贪婪匹配和非贪婪匹配（默认），想让他不贪婪：个位数后面加个？
	- re.search、re.match、re.findall
安装第三方模块：
	- pip管理工具
	- 源码
	- wheel包
```



# jQuery

jQuery是一个JavaScript第三方模块（第三方类库）	 https://code.jquery.com/jquery-3.6.0.min.js

- 基于jQuery自己开发一个功能
- 现成的工具，依赖jQuery，例如：BootStrap动态效果

**引用：**

```js
<script src="static/jquery-3.6.0.min.js"></script>
```

## 寻找标签

- ID选择器

```markdown
<h1 id="txt">中国联通</id>

$("txt")
```

- 样式选择器

```markdown
<h1 class="c1">中国联通</id>

$(".c1")
```

- 标签选择器

```markdown
<h1 class="c1">中国联通</id>

$("h1")
```

- 层级选择器

```html
<h1 class="c1">中国联通</id>
	<h1 class="c2">
		<span></span>
        <a></a>
	</h1>

$(".c1 .c2 a")
```

- 多选择器

```html
<h1 class="c1">中国联通</id>
	<h1 class="c2">
		<span></span>
        <a></a>
	</h1>

$("#c1,#c2,span")
```

- 属性选择器

```html
<input type="text" name="n1" />
<input type="text" name="n1" />
<input type="text" name="n2" />

$("input[name='n1']")
```

- 间接_找到兄弟

```html
<div>
    <div>北京</div>
    <div id='c1'>上海</div>
    <div>深圳</div>
    <div>广州</div>
</div>

$("#c1").prev()
$("#c1")
$("#c1").next()
$("#c1").next().next()

$("#c1").siblings()		// 找到所有的兄弟
```

- 找父子

```html
<div>
	<div>
    	<div>北京</div>
    	<div id='c1'>上海
        	<div>宝山区</div>
        	<div class="p10">浦东新区</div>
        </div>
    	<div>深圳</div>
    	<div>广州</div>
	</div>
</div>

$("#c1").parent().parent()
$("#c1").child(".p10")

$("#c1").find(".p10")	// 去所有子孙中寻找class=p10的标签
$("#c1").find("div")
```

## --案例：菜单的切换

```html
// 点击菜单名展示菜单列表，再次点击收回去

.menus{
	width: 200px;
	height: 800px;
	border: 1px solid red;
}
.menus .header{
	background-color: gold;
	padding: 10px 5px;
	border-bottom: 1px dotted #dddddd;

	cursor: pointer;        // 鼠标放上去变成小手
}
.menus .content a{
	display: block;
	padding: 5px 5px;
	border-bottom: 1px dotted #dddddd;
}
.hide{
	display: none;
}

<div class="menus">
	<div class="item">
    	<div class="header" onclick="clickMe(this)">上海</div>
        <div class="content hide">
        	<a>宝山区</a>
        	<a>青浦区</a>
        	<a>浦东新区</a>
        	<a>普陀区</a>
        </div>
    </div>
    <div class="item">
    	<div class="header" onclick="clickMe(this)">北京</div>
        <div class="content hide">
        	<a>海淀区</a>
        	<a>朝阳区</a>
        	<a>大兴区</a>
        	<a>昌平区</a>
        </div>
    </div>
    <div class="item">
    	<div class="header" onclick="clickMe(this)">福建</div>
        <div class="content hide">
        	<a>福州</a>
        	<a>厦门</a>
        	<a>泉州</a>
        	<a>莆田</a>
        </div>
    </div>
</div>

<script src="static/jquery-3.6.0.min.js"></script>
<script type="text/javascript">
	function clickMe(self){
		// 让自己下面的列表展示出来，再次点击就收回来
        var hasHide = $(self).next().hasClass("hide");
		if(hasHide){
			$(self).next().removeClass("hide");
		}else{
			$(self).next().addClass("hide");
		}
        
        // 自己的列展开时，让别的列表收起来
        $(self).parent().siblings().find(".content").addClass("hide")
	}
</script>
```

## 操作样式

- addClass
- removeClass
- hasClass
- append

## 值的操作

```html
<div id='c1'>内容</div>

$("#c1").text()			// 获取文本内容
$("#c1").text("休息")	   // 设置文本内容

<input type="text" id="c2" />

$("#c2").val()			// 获取用户输入的值
$("#c2").val("哈哈哈")	  // 设置值

```

## --案例：动态创建数据

```html

<input type="text" id="txtUser" placeholder="用户名">
<input type="text" id="txtEmail" placeholder="邮箱">
<input type="button" value="提交" onclick="getInfo()">

<ul id="view"></ul>

<script src="static/jquery-3.6.0.min.js"></script>
<script type="text/javascript">
    function getInfo(){
        var username = $("#txtUser").val();
        var email = $("#txtEmail").val();
        var dataString = "用户名：" + username + "---密码：" + email;

        var newLi = $("<li>").text(dataString);
        $("#view").append(newLi);
    }
</script>
```

## jQuery的绑定事件

```html
<ul>
    <li>百度</li>
    <li>谷歌</li>
    <li>搜狗</li>
</ul>

<script src="static/jquery-3.6.0.min.js"></script>
<script type="text/javascript">
	$("li").click(function(){		// li标签中，点击哪个，那个就显示在控制台
        var text = $(this).text();
        console.log(text);
        
       // $(this).remove();  点击那个li就删除哪个
    })
</script>
```

想让某些事件在 html 页面框架加载完就加载，而不是页面全加载完（加载图片之类的）才加载（比放在body尾部更快点）：

```html
<script type="text/javascript">
	$(function(){
        // 要执行的事件
    })
</script>
```

## --案例：点击删除表格一整行

```html
<tr>
	<td>张三</td>
	<td>19</td>
    <td>
    	<input type="button" value="删除" class="delete" />
    </td>
</tr>

<script type="text/javascript">
	$(function(){
        $(".delete").click(function(){
            $(this).parent().parent().remove();
        })
    })
</script>
```

## BootStrap标准的网站模板

```html
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Document</title>
  <link rel="stylesheet" href="static/plugins/bootstrap-3.4.1/css/bootstrap.css">
  <link rel="stylesheet" href="static/plugins/font-awesome-4.7.0/css/font-awesome.css">
  <style>
    /* CSS*/
  </style>
</head>
<body>

  <!-- HTML -->

  <script src="static/js/jquery-3.6.0.min.js"></script>
  <script src="static/plugins/bootstrap-3.4.1/js/bootstrap.js"></script>
  <script>
    // JS,JQuery
  </script>
</body>

</html>
```

# MySQL

## MySQL安装和配置

- 我这是安装版的，装完直接可以用

  ```
  // 我这里是MySQL8.0
  net start MySQL80
  net stop MySQL80
  ```

  

- 以下是免安装版MySQl安装和配置

- 下载补丁和安装包，补丁：dxwebsetup.exe和vcredist_x64.exe

- 先装补丁再装软件

**MySQL启动、关闭和连接**

- 启动
  
  - 1. 临时启动
  
    - 打开管理员cmd，执行指令...mysqld.exe，启动。关闭窗口mysql也会自动关闭
  
  - 2. 制作成Windows服务，来进行关闭和开启（可以开机自动运行，不用手动打开）
  
    ```shell
    输入cmd在管理员模式下运行：
    "G:\Program Files\MySQL\MySQL Server 8.0\bin\mysqld.exe" --install mysql123
    //Service successfully installed.
    
    net start mysql123
    // mysql123 服务正在启动 ...mysql123 服务已经启动成功。
    
    net stop mysql123
    //mysql123 服务正在停止. mysql123 服务已成功停止。
    ```
  
    ```markdown
    一些错误提示：
    1.Install/Remove of the Service Denied!		
    			-- 搜索框输入cmd，以管理员方式运行
    
    2.mysql: [ERROR] mysql: unknown option		
    			-- 指令输入错误，如：mysqld.exe漏了个d
    
    3.mysql157 服务正在启动 .. mysql157 服务无法启动。  服务没有报告任何错误。   
    			-- 去mysql安装的某磁盘根目录下找到ProgramData，进去删了mysql的data文件夹，管理员cmd进入mysql的/bin/，执行：mysqld --initialize
    
    4.The service already exists!
      The current server installed: "D:\Program Files\Tool\MySQL\MySQL\bin\mysqld.exe" mysql157
    			-- 管理员运行CMD，执行sc query mysql，执行sc delete mysql
    			
    
    ```
  
    ​	桌面启动方式：打开任务管理器-->详细信息-->服务-->打开服务-->找到mysql123，启动
  
  - 连接，进入mysql
  
    ```
    【"G:\Program Files\MySQL\MySQL Server 8.0\bin\mysql.exe" -h 127.0.0.1 -P 3306 -u root -p】
    //Enter password: 	首次登录没有密码，直接回车
    (如果需要密码，你以前装过mysql。检查环境变量或者关闭那个mysql服务，打开这个mysql)
    
    【"G:\Program Files\MySQL\MySQL Server 8.0\bin\mysql.exe" -u root -p 只连接自己可以这样写】
    
    为了更简便，将前面的目录加到环境变量中：右键此电脑，属性，高级系统设置，高级，环境变量，设置path...
    
    ==>以后只要在终端输入这个指令就能进行连接：mysql -u root -p
    
    此时进入了mysql:
    mysql> 
    ```
  
  - 设置密码
  
    ```
    mysql> set password = password("root123");
    ```
  
  - ​	查看已有的文件夹
  
    ```
    mysql> show databases;
    ```
  
  - 关闭连接，退出mysql，回到终端
  
    ```
    mysql> exti;
    ```
  
  - 忘记密码
  
    ```
    停止当前mysql服务
    修改配置文件：找到my.ini，加上一句skip-grant-tables=1，进入无账号模式
    重新启动mysql服务
    再次连接mysql可以直接进去，无需密码
    
    设置密码：
    mysql>use mysql;
    mysql>update user set authentication_string=password('新密码')\
    , password_last_change=now() where user='root'；
    
    停止服务，重新修改配置文件：那一句删掉，启动服务
    再次连接mysql，输入密码就可以进入了
    ```
  
    

## MySQL指令

**数据库管理：**

- 查看已有数据库

  ```
  show databases;
  ```

- 创建数据库

  ```
  create database 数据库名字 DEFAULT CHARSET utf8 COLLATE utf8_general_ci;
  ```

- 删除数据库

  ```
  drop database 数据库名字;
  ```

- 进入数据库

  ```
  use 数据库名字;
  ```

- 查看当前数据库中所有的数据表

  ```sql
  show tables;
  ```

**数据表管理：**

- 创建表

  ```mysql
  create table 表名称(
  	列名称 类型,
  	列名称 类型,
  	列名称 类型,
  )default chartset=utf8;
  
  例子：
   create table tb1(
  	id int auto_increment primary key,				 
  	name varchar(16) not null,		
  	age int default 3			   
  )default charset=utf8;
  
  	-- primary ket：主键（不允许为空，不允许重复），一般用于表示当前行的数据的编号
  	-- auto_increment：内部维护自增
  	-- not null：不允许为空、null：允许为空
  	-- default 3：插入数据时设置默认值为3
  ```

- 删除表

  ```sql
  drop table 表名称;
  ```

- 查看表结构详细信息

  ```sql
  desc 表名称;
  ```

  

**数据行操作**

- 新增数据

  ```sql
  insert into 表名(属性1，属性2) values（值1，值2）;
  
  insert into 表名(属性1，属性2) values（值1，值2）,(值，值)，（值，值）;	-- 批量插入 行数据
  ```

- 删除数据

  ```sql
  delete from 表名;
  
  delete from 表名 where 条件;
  ```

- 修改数据

  ```sql
  update 表名 set 列=值;
  
  update 表名 set 列=值, 列=值;
  
  update 表名 set 列=值 where 条件;
  ```

- 查询数据

  ```sql
  select * from 表名;
  
  select 列名,列名 from 表名 where 条件;
  ```

  

## 常用数据类型

- 整数

  - tinyint

    ```sql
    tinyint				-- 默认为有符号，-128 ~ 127
    tinyint unsigned	 -- 无符号，0 ~ 255
    ```

  - int
  - bigint

- 浮点数

  - float

  - double

  - decimal

    ```sql
    decimal(m,d)		-- m是数字总位数（负号不算），d是小数点后位数。最多位数 65 = ？ + 30 ，存储会四舍五入
    ```

- 字符串
  - char		定长字符串：只按固定长度存储（最大为255个字节），数据太长会报错（优点：查询速度更快）
  - varchar   变长字符串：数据多长就按多长存储（最大65535字节，/3=21844个汉字）
  - text        用于保存变长的大字符串，最多2**16-1=65535个字节。一般用于文章、新闻等长文本
  - mediumtext    2**24-1
  - longtext          2**32-1

- 时间
  - datetime：YYYY-MM-DD HH:MM:SS
  - date：YYYY-MM-DD



## 利用Python操作数据库

创建数据：

```python
import pymysql

while True:
    user = input("用户名：")
    if user.upper == 'Q':
        break
    pwd = input("密码：")
    mobile = input("手机号：")

    # 1. 连接MySQL
    conn = pymysql.connect(host="127.0.0.1", port=3306, user='root', passwd="123456", charset='utf8',db='mydb')
    cursor = conn.cursor(cursor=pymysql.cursors.DictCursor)

    # 2.1 发送指令
    cursor.execute("insert into user(username,password,mobile) values('zhangsan','qwe123','16887988')")
    conn.commit()

    # 3. 关闭连接
    cursor.close()
    conn.close()

    ——————————————————————————————————————————————————————————————————————
    # 2.2 发送指令
    sql = "insert into user(username,password,mobile) values(%s,%s,%s)"
    cursor.execute(sql,[user, pwd, mobile])
    conn.commit()


    # 2.3 发送指令
    sql = "insert into user(username,password,mobile) values(%(n1)s,(n2)%s,(n3)%s)"
    cursor.execute(sql,{"n1":user, "n2":pwd, "n3":mobile})
    conn.commit()
```

查询数据：

```sql
# 2. 发送查询指令
cursor.execute("select * from user where id > %s",[2, ])
data_list = cursor.fetchall()		// fetchall（）获取的是 [字典，字典]，无数据是空列表
for row_dict in data_list:			// fetchone()只获取符合条件的的第一条数据，是个字典，无数据是None
print(row_dict)
```

删除数据

```sql
# 2. 发送删除数据指令
cursor.execute("delete from user where id = %s",[3, ])
conn.commit()
```

修改数据

```sql
# 2. 发送修改数据指令
cursor.execute("update user set mobile = %s where id = %s",["18888888", 4,  ])
conn.commit()
```

注意：新增、删除、修改数据时，一定要记得conn.commit()，不然数据库没有数据

​			查询时不需要，但是要fetchall()/fetchone()

​			对SQL语句不要用Python的字符串格式化进行拼接（会被SQL注入），一定要用 execute + 参数

## 案例：Flask+前端+MySQL

制作两个页面，一个用来添加数据，一个用来展示表格

```python
# app.py
from flask import Flask, render_template, request
import pymysql

app = Flask(__name__)

@app.route("/add/user", methods=["GET", "POST"])
def add_user():
    if request.method == "GET":
        return render_template("add_user.html")
    
    username = request.form.get("user")
    password = request.form.get("pwd")
    mobile = request.form.get("mobile")

    conn = pymysql.connect(host="127.0.0.1", port=3306, user='root', passwd="123456", charset='utf8',db='flask_db')
    cursor = conn.cursor(cursor=pymysql.cursors.DictCursor)
    sql = "insert into user(username,password,mobile) values(%s,%s,%s)"
    cursor.execute(sql, [username, password, mobile])
    conn.commit()
    cursor.close()
    conn.close()
   
    return "添加成功"

@app.route("/show/user") 
def show_user():
    # 从数据库获取所有的用户信息
    conn = pymysql.connect(host="127.0.0.1", port=3306, user='root', passwd="123456", charset='utf8',db='flask_db')
    cursor = conn.cursor(cursor=pymysql.cursors.DictCursor)
    sql = "select * from user"
    cursor.execute(sql)
    data_list = cursor.fetchall()
    cursor.close()
    conn.close()

    print(data_list)
    return render_template("show_user.html", data_list=data_list)


if __name__ == '__main__':
    app.run()    
```

```html
<!-- /templates/add_user.html -->
<h1>添加用户</h1>

<form action="/add/user" method="post">
  <input type="text" name="user" placeholder="用户名">
  <input type="text" name="pwd" placeholder="密码">
  <input type="text" name="mobile" placeholder="手机号">
  
  <input type="submit" value="提交">
</form>
```

```html
<!-- /templates/show_user.html -->
<head>
    <meta charset="UTF-8">
    <title>Document</title>
    <link rel="stylesheet" href="/static/plugins/bootstrap-3.4.1/css/bootstrap.css">
</head>
<body>  
    <div class="container">
        <h1>用户列表</h1>
        <table class="table table-bordered">
            <thead>
                <tr>
                    <th>ID</th>
                    <th>姓名</th>
                    <th>密码</th>
                    <th>手机号</th>
                </tr>
            </thead>
            {% for item in data_list %}
                <tbody>
                    <tr>
                        <td>{{ item.id }}</td>
                        <td>{{ item.username }}</td>
                        <td>{{ item.password }}</td>
                        <td>{{ item.mobile }}</td>
                    </tr>
                </tbody>
            {% endfor %}
        </table>
    </div>
    <script src="/static/js/jquery-3.6.0.min.js"></script>
    <script src="/static/plugins/bootstrap-3.4.1/js/bootstrap.js"></script>
</body>
```

```sql
//数据库flask_db --> user表
create database flask_db DEFAULT CHARSET utf8 COLLATE utf8_general_ci;

create table user(
	id int auto_increment primary key,				 
	username varchar(30) not null,	
    password varchar(10) not null,	
	age int default 0			   
)default charset=utf8;
```

![image-20220409213247466](Typora图片路径/image-20220409213247466.png)



# Django学习

## MTV

略

## 创建Django项目

打开终端，进入Django文件夹
安装虚拟环境：

```shell
pip install virtualenv -i http://pypi.douban.com/simple --trusted-host pypi.douban.com
```

创建虚拟环境：

```shell
virtualenv env
```

激活虚拟环境：

```shell
env\scripts\activate
```

停用则是deactivate  （虚拟环境env会自带python和pip）

不创建虚拟环境则 pip install 默认安装路径为 G:\python-3.10.3\Scripts 

在env中安装Django：

```shell
pip install django -i http://pypi.douban.com/simple --trusted-host pypi.douban.com
```

创建Django项目：

```shell
django-admin startproject mysite
```

启动项目：

```shell
python manage.py runserver
```

ctrl + c 关闭项目

创建APP：

```shell
python manage.py startapp app01
```

在settings.py中注册APP：

```python
INSTALLED_APPS = [		# 都是Django内置的一些功能，依赖于Django的表
    'django.contrib.admin',
    'django.contrib.auth',
    'django.contrib.contenttypes',
    'django.contrib.sessions',
    'django.contrib.messages',
    'django.contrib.staticfiles',
    'app01.apps.App01Config',		# 注册APP01，逗号别漏了
]
```

修改语言和时区

```python
LANGUAGE_CODE = 'zh-hans'

TIME_ZONE = 'Asia/Shanghai'
```

## ORM_数据库操作

**概念**

通过编写代码，ORM框架自动将代码转换为数据库语句，Django开发操作数据库更简单

<img src="E:\Typora学习笔记\Typora图片路径\image-ORM_notation.png" alt="image-20220405153414401" style="zoom:67%;" />

ORM帮我们完成：

- 创建、修改、删除数据库中的表（无法创建数据库）
- 操作表中的数据，不用SQL语句

## **Django连接MySQL**

**安装插件模块：**

方案1：在/scripts 中安装pymysql模块(推荐)

```shell
pip install pymysql -i https://pypi.doubanio.com/simple/  --trusted-host pypi.doubanio.com
```

 _ init_.py中设置数据库连接

```
import pymysql
pymysql.install_as_MySQLdb()
```

方案2：安装mysqlclient（Django 4才行）

```shell
pip install mysqlclient
```

报错就去mysqlclient-PyPi下载包，安装包

<img src="E:\Typora学习笔记\Typora图片路径\image-download_mysqlclient-PyPi.png" alt="image-20220405154118991" style="zoom:50%;" />

————————————————————————————————————————————————————

首先生成数据库

进入MySQL Command Line Clint用指令：

```sql
create database mydb DEFAULT CHARSET  utf8 COLLATE utf8_general_ci;
```

或者在Navicat新建（utf8mb4，utf8mb4_general_ci: 不在意大小写）

修改settings.py让Django自动链接MySQL

```python
DATABASES = {
    'default': {
        'ENGINE': 'django.db.backends.mysql',
        'NAME': 'mydb',		# 数据库名字
        'USER': 'root',
        'PASSWORD': '123456',
        'HOST': 'localhost',
        'PORT': 3306,
    }
}
```

```python
# __init__.py	将pymysql 伪装成MySQLdb

import pymysql
pymysql.install_as_MySQLdb()
```

## **Django创建表+增删改查**

在models.py 文件中操作类，此时在Django底层已经自动生成对应的操作MySQL的代码，

每个表自动生成 id 属性，BigAutoField类型（bigint、主键且自增）

```sql
from django.db import models

class UserInfo(models.Model):
    name = models.CharField(max_length=32)	
    password = models.CharField(max_length=64)
    age = models.IntegerField()
————————————————Django底层———————————————————————
create table app01_userinfo(
	id bigint auto_increment primary key,
	name varchar(32),
	password varchar(64),
	age int	
)
```

**数据迁移**：

```shell
python manage.py makemigrations
python manage.py migrate
```



**修改表**：在models.py 中修改模型，在表中新增列时，由于已存在列可能已有数据，必须指定对应数据

makemigrations时有两个选择：

![image-20220405163637109](E:\Typora学习笔记\Typora图片路径\image-makemigrations_add_column.png)

选1：输入一个值为整列的默认值

选2：在模型的属性中加入默认值，再次迁移就行了

```sql
 age = models.IntegerField(defaul=2)
```

方法3：在属性中让值可以为空

```sql
 data = models.IntegerField(null=True, balnk=True)
```

## 手动删除数据库后再次迁移不生成数据表

```
首先删除migrations文件下除了__init__.py以外的所有文件
打开数据库终端，进入指定的数据库：
use xx_db;
输入以下指令：
delete from django_migrations where app = "app01";

回到项目重新迁移
```





## **增删改查MySQL数据**

添加数据：

```sql
UserInfo.objects.create(name="peiqi",password="123",age="19")
```

删除数据：

```sql
UserInfo.objects.all().delete()
UserInfo.objects.filter(id=3).delete()
```

获取数据：

```sql
data_list = UserInfo.objects.all()	# 得到QuerySet类型数据
for obj in data_list:
	print(obj.id, obj.name, obj.password, obj.age)
	
data_list = UserInfo.objects.filter(id=1)	# 得到依然是QuerySet数据
row_obj = UserInfo.objects.filter(id=1)。first()	# 得到一个数据对象
print(row_obj.id, row_obj.name, row_obj.password, row_obj.age)
```

更新数据：

```sql
UserInfo.objects.filter(id=2).update(password=999)
```



**补充（创建超级用户）**：

```shell
python manage.py createsuperuser
```

（数据迁移后拥有admin表）打开/damin/ ，登录查看



## 数据表设计技巧

UerInfo的外键depart_id  绑定到  Department的主键id，当某部门被删除时：

1. 删除用户，用级联删除
2. 置空，没有值，注意要让这一列可以为空

```sql
 depart_id = models.ForeignKey(to="Department", to_field="id", on_delete=models.CASCADE)
 
 depart_id 
 = models.ForeignKey(to="Department",to_field="id",null=True,blank=True,on_delete=models.SET_NULL)
```

用元组限制属性的值；verbose_name =" "为注解，防止忘记

```sql
# 在Django中做的约束，gender只能是1或2
gender_choices = (
    (1, "男"),
    (2, "女"),
)
gender = models.SmallIntegerField(verbose_name="性别", choices=gender_choices)
```



## 静态文件和模板文件

**配置静态文件（static）**

1、在应用目录下创建 static 目录

2、在 static 目录下创建 css 目录，js 目录，images 目录，plugins 目录， 分别放 css文件，js文件，图片和插件（BootStrap）

3、在 html 页面第一行，从静态目录中引入：

```django
{% load static %}
```

**配置模板文件（templates）**

在项目文件下创建 templates 目录，用来存放 html 文件



## 请求与响应

request是一个对象，封装了用户发过来的所有请求相关数据

```python
request.method	# 获取请求方法，GET/POST
request.GET		# 在URL上传值，../?n1=123&n2=999/，返回<QueryDict:{'n1':['123'], 'n2':['999']}>
request.POST	# 在请求体中提交数据，返回<QueryDict:{}>

HttpResponse("string")		# 返回字符串
render(request, 'login.html', {"msg":msg})	# 浏览器request->urls.py->views.py：render()读取templates的html内容并进行渲染（替换），再返回给浏览器
redirect("http://www.baidu.com")	# 浏览器->Django，返回重定位网址，浏览器再自己去搜索
```





## 模板语法

**变量**

```html
view.py：{"HTML变量名" : views变量名}
HTML：{{ 变量名 }}	   
```

**列表**

```python
# views.py
from django.shortcuts import render

def runoob(request):
    views_list = ["菜鸟教程1","菜鸟教程2","菜鸟教程3"]
    return render(request, "runoob.html", {"views_list": views_list})
```

```html
<!-- runoob.html -->
<p>{{ views_list }}</p>   # 取出整个列表
<p>{{ views_list.0 }}</p> # 取出列表的第一个元素
```

**字典**

```python
# views.py
from django.shortcuts import render

def runoob(request):
    views_dict = {"name":"菜鸟教程"}
    return render(request, "runoob.html", {"views_dict": views_dict})
```

```html
<!-- runoob.html -->
<p>{{ views_dict }}</p>
<p>{{ views_dict.name }}</p>
```

**过滤器**

```html
{{ 变量名 | 过滤器：可选参数 }}
```

过滤器可以套接，可以有参数

过滤器：

```markdown
lower	# 全小写
upper	# 全大写
first	# 选取第一个参数
length	# 返回对象1、的长度，适用于字符串和列表
default	# 为变量提供一个默认值
safe	#将字符串标记为安全，不需要转义
date	# 按指定的格式字符串参数格式化 date 或者 datetime 对象，例：date:"F j, Y"，date:"Y-m-d H:i:s"
truncatewords:"30"	# 显示前30个词
addslashes	# 添加反斜杠到任何反斜杠、单引号或者双引号前面
filesizeformat	# 以更易读的方式显示文件的大小，KB、MB等
truncatechars:30	# 字符串总数多于30，则多余部分截断变为...

```

**if/else 标签**

```django
{% if condition1 %}
   ... display 1
{% elif condition2 %}
   ... display 2
{% else %}
   ... display 3
{% endif %}
```

**for 标签**

```django
<ul>
{% for athlete in athlete_list %}
    <li>{{ athlete.name }}</li>
{% empty %}
    循环为空时执行，即athlete_list为False时
{% endfor %}
</ul>
```

for标签变量

- forloop.counter: 顺序获取循环序号，从 1 开始计算
- forloop.counter0: 顺序获取循环序号，从 0 开始计算
- forloop.revcounter: 倒序获取循环序号，结尾序号为 1
- forloop.revcounter0: 倒序获取循环序号，结尾序号为 0
- forloop.first（一般配合if标签使用）: 第一条数据返回 True，其他数据返回 False
- forloop.last（一般配合if标签使用）: 最后一条数据返回 True，其他数据返回 False

**ifequal/ifnotequal 标签**

```django
{% ifequal section 'sitenews' %}
    <h1>Site News</h1>
{% else %}
    <h1>No News Here</h1>
{% endifequal %}
```

**注释标签**

```django
{# 这是一个注释 #}
```

**include 标签**

```django
{% include "nav.html" %}
```

允许在模板中包含其它的模板的内容

**自定义标签和过滤器**

搜：菜鸟教程

**csrf_token**

```django
{% csrf_token %} 
```

用于form表单中，作用是跨站请求伪造保护

**若不用此标签，在提交 form 表单时，再次跳转页面会报 403 权限错误**

流程：1. 向服务器发送请求，获取 login.html，同时中间件csrf自动生成一个隐藏input标签（value=随机字符串），用户同时获取到 				login.html 和隐藏input。

​			2. 当在 login.html 用 form 表单提交数据时，会将隐藏input一并交给中间件csrf。

​			3. csrf接收到数据时会判断这个随机字符串是不是第一次发给用户那个，如果不是则返回403权限错误。

**模板继承**

父模板

```django
{% block 名称 %} 
预留给子模板的区域，可以设置默认内容
{% endblock 名称 %}
```

子模板

```django
{% extends "父模板路径"%} 

{% block 名称 %}
子模板覆盖父模板的内容 
{% endblock 名称 %}
```

在Django项目中常用模板继承，一个页面可以有多个模板，相互嵌套

## 案例：显示用户数据+增删功能

1. 展示用户列表

   - url

   - 函数
     - 获取所有用户信息
     - HTML渲染

2. 添加用户

   - url
   - 函数
     - GET，看到页面，输入内容
     - POST，提交->写入数据库

3. 删除用户

   - url
   - 函数

配置好数据库并迁移,添加一些数据，以下是用到的文件：

```python
#urls.py
from django.contrib import admin
from django.urls import path
from app01 import views

urlpatterns = [
    path('admin/', admin.site.urls),
    path('info/list/', views.info_list),
    path('info/add/', views.info_add),
    path('info/delete/', views.info_delete),
]
```

```python
#models.py
from django.db import models

class UserInfo(models.Model):
    name = models.CharField(max_length=32)
    password = models.CharField(max_length=64)
    age = models.IntegerField()
```

```python
#views.py
from django.shortcuts import render, redirect
from app01.models import UserInfo

def info_list(request):
    # 获取数据库所有用户信息
    data_list = UserInfo.objects.all()
    print(data_list)

    return render(request, "info_list.html", {"data_list":data_list})

def info_add(request):
    if request.method == "GET":
        return render(request, 'info_add.html')
    # 获取用户提交的数据
    user = request.POST.get("user")
    pwd = request.POST.get("pwd")
    age = request.POST.get("age")
    # 添加到数据库
    UserInfo.objects.create(name=user, password=pwd, age=age)
    # 自动跳转
    return redirect("/info/list/")

def info_delete(request):
    nid = request.GET.get('nid')
    UserInfo.objects.filter(id=nid).delete()
    return redirect("/info/list/")
```

```html
<!-- info_list.html -->
<h1>INFO列表</h1>
<a href="/info/add/">添加</a>
<table border = "1">
    <thead>
        <tr>
            <th>ID</th>
            <th>姓名</th>
            <th>密码</th>
            <th>年龄</th>
            <th>操作</th>
        </tr>
    </thead>
    {% for obj in data_list %}
    <tbody>
        <tr>
            <td>{{obj.id}}</td>
            <td>{{obj.name}}</td>
            <td>{{obj.password}}</td>
            <td>{{obj.age}}</td>
            <td>
                <a href="/info/delete/?nid={{ obj.id }}">删除</a>
            </td>
        </tr>
    </tbody>
    {% endfor %}
</table>
```

```html
<!-- info_add.html -->
<h1>添加用户</h1>
<form method="post" >
    {% csrf_token %}
    <input type="text" name="user" placeholder="用户名">
    <input type="text" name="pwd" placeholder="密码">
    <input type="text" name="age" placeholder="年龄">
    <input type="submit" value="提交">
</form>
```

实现效果：

<img src="E:\Typora学习笔记\Typora图片路径\image-20220405_info_list.png" alt="image-20220405200124937" style="zoom: 50%;" />

<img src="E:\Typora学习笔记\Typora图片路径\image-20220405_info_add.png" alt="image-20220405200243328" style="zoom:50%;" />



## 进阶：用户数据展示+增删改查

新建用户：

- 原始方法思路【不采用，太麻烦】

  ```python
  - 用户提交的数据没有校验
  - 输入错误，页面上没有错误提示
  - 页面上每一个字段的代码都需要我们重新写一遍
  - 关联的数据，需要手动去获取并循环展示在页面
  
  {% extends 'layout.html' %}
  
  {% block content %}
  <div class="container">
      <div class="panel panel-default">
          <div class="panel-heading">
              <h3 class="panel-title"> 添加用户</h3>
          </div>
          <div class="panel-body">
              <form method="post">
                  {% csrf_token %}
                  <div class="form-group">
                      <label >姓名</label>
                      <input type="text" class="form-control" placeholder="姓名" name="user">
                  </div>
   				......
                  <div class="form-group">
                      <label >性别</label>
                      <select class="form-control" name="gd">
                          {% for item in gender_choices %}
                              <option value="{{ item.0 }}">{{ item.1 }}</option>
                          {% endfor %}
                      </select>
                  </div>
                  <div class="form-group">
                      <label >部门</label>
                      <select class="form-control" name="dp">
                          {% for item in depart_list %}
                              <option value="{{ item.id }}">{{ item.title }}</option>
                          {% endfor %}
                      </select>
                  </div>
                  <button type="submit" class="btn btn-primary">提 交</button>
              </form>
          </div>
      </div>
  </div>
  {% endblock %}
  
  def user_add(request):
      """添加用户"""
      if request.method == "GET":
          context = {
              'gender_choices':models.UserInfo.gender_choices,
              'depart_list':models.Department.objects.all()
          }
          return render(request, "user_add.html", context)
  
      user = request.POST.get("user")
      pwd = request.POST.get("pwd")
      age = request.POST.get("age")
      account = request.POST.get("ac")
      ctime = request.POST.get("ctime")
      gender = request.POST.get("gd")
      depart_id = request.POST.get("dp")
  
      models.UserInfo.objects.create(name=user,password=pwd,age=age,
                                     account=account,create_time=ctime,
                                     gender=gender,depart_id=depart_id)
      return redirect("/user/list/")
  ```

- Django组件

  ```
  Form组件（更简便）
  ModelForm组件（最简便）
  	- form表单提交到数据库，可以进行校验
  	- 将页面中的数据展示出来
  	- 输入出错，提示错误信息时，正确的信息还保留着
  ```

## 初识Form

views.py

```python
class MyForm(Form):
    user = forms.CharField(widget=forms.Input)		# 加入这个插件，以后可以在html页面中帮助生成input框
    pwd = form.CharField(widget=forms.Input)		# 不论在views中还是form表单代码，都会更简洁
    age = form.CharField(widget=forms.Input)
    account = form.CharField(widget=forms.Input)
    ctime = form.CharField(widget=forms.Input)
    gender = form.CharField(widget=forms.Input)
    depart_id = form.CharField(widget=forms.Input)
    
    
def user_add(request):
    if request.method == "GET":
        form() = MyForm()		# 实例化一个MyForm对象,比起上面的案例少写一堆代码
        return render(request, 'user_add.html', {"form":form})
```

user_add.html

```html
<form method="post">
    {{ form.user }}		<!-- 会自动帮助生成html标签 -->
    {{ form.pwd }}		<!-- form用起来也方便 -->
    {{ form.email }}
    <!-- 类似于：<input type="text" placeholder="姓名" name="user"> -->
</form>

<!-- 还能更简便↓↓↓ -->
<form method="post">
	{% for field in form %}
    	{{ field }}				<!-- 当字段很多时优势就显现出来了 -->
    {% endfor %}
</form>
```

用Form的好处：不需要每一个字段的代码都重新写一遍，简洁了

缺点：Form的字段还得自己手动去写（但和models.py中的字段有转换关系），因此可以用ModelForm进行再次优化

## ModelForm

models.py

```python
from django import forms

class UserModelForm(forms.ModelForm):		// 比起Form里面的字段，ModelForm显得更简洁
    class Meta:							  //通过一个内嵌类 "class Meta" 给你的 model 定义元数据
        model = models.UserInfo
        fields = ["name","password","age","account","create_time","gender","depart"]
        # 输出对象时，如果想要定制显示的内容，在models类中定义__str__(self)，输出当前self对象封装的值


def user_model_form_add(request):
    """添加用户（ModelForm）"""
    form = UserModelForm()
    return render(request, "user_model_form_add.html", {"form":form})
```

user_model_form_add.html

```python
<form method="post">
	{% csrf_token %}
        
    {% for field in form %}
    	{{field.label}}: {{field}}		//前端代码一点不变，只要修改views中的fields就行
    {% endfor %}					   //放面板里美化一下就行
</form>
```

## 最终项目：联通用户管理系统

```python
部门管理

用户管理
- 用户列表
- 新建用户
	ModelForm，针对数据库中的某个表
	Form
- 编辑用户
	点击编辑，跳转到编辑页面（将编辑行的ID携带过去）
	编辑页面（默认数据，根据ID获取并设置到页面中）
	提交：错误提示
		 数据校验
		 在数据库更新
- 靓号列表
	URL
	函数
		获取所有的靓号
		结合html+render将靓号罗列出来	ID 号码 价格 级别(中文) 状态(中文)
- 新建靓号
	列表页面点击跳转
	URL
	MoldeForm
	函数
		实例化类对象
		通过render将对象传入到HTML中
		模板的循环展示所有的字段
	点击提交
		数据校验
		保存到数据库
		跳转回靓号列表
- 编辑靓号
	页面列表: /pretty/数字/edit
	URL
	函数
		根据ID获取当前编辑的对象
		ModelForm配合，默认显示数据
		提交修改
	不允许手机号重复
		添加:【正则表达式】【手机号不能存在】
            #[obj,obj,obj]
            queryset = models.PrettyNum.object.filter(mobile='18888888')

            boj = models.PrettyNum.objects.filter(mobile='18888888').first()

            # True/False
            exists = models.PrettyNum.objects.filter(mobile='18888888').exists()
            
        编辑：【正则表达式】【手机号不能存在】
        	排除自己以外，其他的数据 手机号是否重复
            # id!=2 and mobile='18888888'
            models.PrettyNum.objects.filter(mobile='18888888').exclude(id=2)

- 搜索框:搜索手机号
	models.PrettyNum.objects.filter(mobile="199999",id=12)
    
    data_dict = {"mobile":"199999","id":123}
    models.PrettyNum.objects.filter(**data_list)	# 可以字典搜索
    
    models.PrettyNum.objects.filter(id=12)		# = 12
    models.PrettyNum.objects.filter(id__gt=12)	# > 12
    models.PrettyNum.objects.filter(id__lte=12)	# <= 12
    models.PrettyNum.objects.filter(mobile__startswith="1999")
    models.PrettyNum.objects.filter(mobile__endswith="999")
    models.PrettyNum.objects.filter(mobile__contains="999")
    
    data_dict = {"mobile__startswith":"1999","id__gt":123}
    models.PrettyNum.objects.filter(**data_list)	

```

## 分页

```python
分页的逻辑和处理规则

<div class="clearfix">
    <ul class="pagination>
        {{ page_string }}   
    </ul>
</div> 

def pretty_list(request):
    """靓号列表"""
    # 添加靓号数据
    # for i in range(300):
    #     models.PrettyNum.objects.create(mobile="18888888888",price=100,level=1,status=1)

    # 搜索框内容，没值就空字符串
    data_dict = {}
    search_data = request.GET.get('q', "")     
    if search_data:
        data_dict["mobile__contains"] = search_data

    # 根据用户想要访问的页码，计算出起止位置
    page = int(request.GET.get('page', 1))
    page_size = 10
    start = (page - 1) * page_size
    end = page * page_size

    queryset = models.PrettyNum.objects.filter(**data_dict).order_by("-level")[start:end]   # 级别高的在上面,字典为空默认搜索所有值

    # 数据总条数
    total_count = models.PrettyNum.objects.filter(**data_dict).order_by("-level").count()
    # 总页码
    total_page_count, div = divmod(total_count, page_size)
    if div:
        total_page_count += 1

    # 计算出当前页的前5页和后5页
    plus = 5
    if total_page_count <= 2 * plus + 1:
        start_page = 1
        end_page = total_page_count 
    else:
        if page <= plus:
            start_page = 1
            end_page = 2 * plus + 1
        else:
            if (page + plus) > total_page_count:
                start_page = total_page_count - 2 * plus
                end_page = total_page_count
            else:
                start_page = page - plus
                end_page = page + plus 
         
    # 页码 由后台计算并加入到前端中
    page_str_list = []
    # 首页
    page_str_list.append('<li><a href="?page={}">首页</a></li>'.format(1))
     # 上一页
    if page > 1:   
        prev = '<li><a href="?page={}">上一页</a></li>'.format(page - 1)
    else:
        prev = '<li><a href="?page={}">上一页</a></li>'.format(1)
    page_str_list.append(prev)
    # 页码
    for i in range(start_page, end_page + 1):
        if i == page:
            ele = '<li class="active"><a href="?page={}">{}</a></li>'.format(i,i)
        else:
            ele = '<li><a href="?page={}">{}</a></li>'.format(i,i)
        page_str_list.append(ele)
    # 下一页
    if page < end_page:
        prev = '<li><a href="?page={}">下一页</a></li>'.format(page + 1)
    else:
        prev = '<li><a href="?page={}">下一页</a></li>'.format(total_page_count)
    page_str_list.append(prev)
    # 尾页
    page_str_list.append('<li><a href="?page={}">尾页</a></li>'.format(total_page_count))

    # 页码搜索框
    search_string = """
        <li>
            <form style="float: left;margin-left: -1px;" method="get">
                <input type="text" name="page" class="form-control" placeholder="页码"
                style="position:relative;float:left;display:inline-block;width: 80px;border-radius:0;" >
                <button style="border-radius: 0;" class="btn btn-default" type="submit">跳转</button>
            </form>
        </li>
    """
    page_str_list.append(search_string)

    page_string = mark_safe("".join(page_str_list))
    
    return render(request, "pretty_list.html", {"queryset":queryset,"search_data":search_data,"page_string":page_string})
```

## 封装分页组件

```python
def pretty_list(request):
    """靓号列表"""
    # 添加靓号数据
    # for i in range(300):
    #     models.PrettyNum.objects.create(mobile="18888888888",price=100,level=1,status=1)

    # 搜索框内容，没值就空字符串
    data_dict = {}
    search_data = request.GET.get('q', "")     
    if search_data:
        data_dict["mobile__contains"] = search_data

    # 封装分页组件
    queryset = models.PrettyNum.objects.filter(**data_dict).order_by("-level")
    page_object = Pagination(request, queryset, 20) 
    context = {
        "search_data":search_data,
        "queryset":page_object.page_queryset, 
        "page_string":page_object.html()   
        }
    
    return render(request, "pretty_list.html", context)


# pagination.py
"""
自定义的分页组件————想要使用这个组件需要做到：

在视图函数中：
    def pretty_list(request):

        # 1.根据自己的情况去筛选自己的数据
        queryset = models.PrettyNum.objects.all()

        # 2.实例化分页对象
        page_object = Pagination(request, queryset)

        context = {
            "queryset":page_object.page_queryset,   # 分完页的数据
            "page_string":page_object.html()   # 生成页码
            }
        
        return render(request, "pretty_list.html", context)

在HTML页面中
    {% for obj in queryset %}
        {{ obj.xx }}
    {% endfor %}

    <ul class="pagination"">
        {{ page_string }}   
    </ul>

参数：
    request：请求的对象
    queryset：数据库中筛选出的符合条件的数据，要进行分页处理的数据
    page_size：每页展示多少条数据
    page_param：在URL中传递的获取分页的参数，例如：/pretty/list/?page=7
    plus：显示当前页的前、后xx页的按钮

"""
from django.utils.safestring import mark_safe

class Pagination(object):

    def __init__(self, request, queryset, page_size=10, page_param="page", plus=5):
        page = request.GET.get(page_param, "1")
        if page.isdecimal():    # 如果输入的不是数字，那就默认为1
            page = int(page)
        else:
            page = 1
        self.page = page
        self.page_size = page_size

        self.start = (page - 1) * page_size
        self.end = page * page_size

        self.page_queryset = queryset[self.start:self.end]

        # 数据总条数
        total_count = queryset.count()
        # 总页码
        total_page_count, div = divmod(total_count, page_size)
        if div:
            total_page_count += 1
        self.total_page_count = total_page_count
        self.plus = plus

    def html(self):
        # 计算出当前页的前plus页和后plus页
        if self.total_page_count <= 2 * self.plus + 1:
            start_page = 1
            end_page = self.total_page_count 
        else:
            if self.page <= self.plus:
                start_page = 1
                end_page = 2 * self.plus + 1
            else:
                if (self.page + self.plus) > self.total_page_count:
                    start_page = self.total_page_count - 2 * self.plus
                    end_page = self.total_page_count
                else:
                    start_page = self.page - self.plus
                    end_page = self.page + self.plus 
            
        # 页码 由后台计算并加入到前端中
        page_str_list = []
        # 首页
        page_str_list.append('<li><a href="?page={}">首页</a></li>'.format(1))
        # 上一页
        if self.page > 1:   
            prev = '<li><a href="?page={}">上一页</a></li>'.format(self.page - 1)
        else:
            prev = '<li><a href="?page={}">上一页</a></li>'.format(1)
        page_str_list.append(prev)
        # 页码
        for i in range(start_page, end_page + 1):
            if i == self.page:
                ele = '<li class="active"><a href="?page={}">{}</a></li>'.format(i,i)
            else:
                ele = '<li><a href="?page={}">{}</a></li>'.format(i,i)
            page_str_list.append(ele)
        # 下一页
        if self.page < end_page:
            prev = '<li><a href="?page={}">下一页</a></li>'.format(self.page + 1)
        else:
            prev = '<li><a href="?page={}">下一页</a></li>'.format(self.total_page_count)
        page_str_list.append(prev)
        # 尾页
        page_str_list.append('<li><a href="?page={}">尾页</a></li>'.format(self.total_page_count))

        # 页码搜索框
        search_string = """
            <li>
                <form style="float: left;margin-left: -1px;" method="get">
                    <input type="text" name="page" class="form-control" placeholder="页码"
                    style="position:relative;float:left;display:inline-block;width: 80px;border-radius:0;" >
                    <button style="border-radius: 0;" class="btn btn-default" type="submit">跳转</button>
                </form>
            </li>
        """
        page_str_list.append(search_string)

        page_string = mark_safe("".join(page_str_list))

        return page_string

```

以后写项目不用重新写这个，直接拿来当公共组件直接用

## 分页组件改进

```python
小bug：当搜索框输入值查询后再点击【分页】或【跳转】，不会在原有搜索条件下进行换页
改进：【分页】：点击分页时，保留地址中原有参数，并加入page参数
	 【跳转】：无法改进需要ajax，跳转无法保留原有地址参数
"""
自定义的分页组件————想要使用这个组件需要做到：

在视图函数中：
    def pretty_list(request):

        # 1.根据自己的情况去筛选自己的数据
        queryset = models.PrettyNum.objects.all()

        # 2.实例化分页对象
        page_object = Pagination(request, queryset)

        context = {
            "queryset":page_object.page_queryset,   # 分完页的数据
            "page_string":page_object.html()   # 生成页码
            }
        
        return render(request, "pretty_list.html", context)

在HTML页面中
    {% for obj in queryset %}
        {{ obj.xx }}
    {% endfor %}

    <ul class="pagination"">
        {{ page_string }}   
    </ul>

参数：
    request：请求的对象
    queryset：数据库中筛选出的符合条件的数据，要进行分页处理的数据
    page_size：每页展示多少条数据
    page_param：在URL中传递的获取分页的参数，例如：/pretty/list/?page=7
    plus：显示当前页的前、后xx页的按钮

"""
from django.utils.safestring import mark_safe

class Pagination(object):

    def __init__(self, request, queryset, page_size=10, page_param="page", plus=5):
        
        from django.http.request import QueryDict
        import copy
        query_dict = copy.deepcopy(request.GET)
        query_dict._mutable = True
        self.query_dict = query_dict
        self.page_param = page_param

        
        page = request.GET.get(page_param, "1")
        if page.isdecimal():    # 如果输入的页码不是数字，那就默认为1
            page = int(page)
        else:
            page = 1
        self.page = page
        self.page_size = page_size

        self.start = (page - 1) * page_size
        self.end = page * page_size

        self.page_queryset = queryset[self.start:self.end]


        # 数据总条数
        total_count = queryset.count()
        # 总页码
        total_page_count, div = divmod(total_count, page_size)
        if div:
            total_page_count += 1
        self.total_page_count = total_page_count
        self.plus = plus


    def html(self):
        # 计算出当前页的前plus页和后plus页
        if self.total_page_count <= 2 * self.plus + 1:
            start_page = 1
            end_page = self.total_page_count 
        else:
            if self.page <= self.plus:
                start_page = 1
                end_page = 2 * self.plus + 1
            else:
                if (self.page + self.plus) > self.total_page_count:
                    start_page = self.total_page_count - 2 * self.plus
                    end_page = self.total_page_count
                else:
                    start_page = self.page - self.plus
                    end_page = self.page + self.plus 
            
        # 页码 由后台计算并加入到前端中
        page_str_list = []
        # 首页
        self.query_dict.setlist(self.page_param, [1])   # 在网址中保留原来的所有参数，再加入page参数
        page_str_list.append('<li><a href="?{}">首页</a></li>'.format(self.query_dict.urlencode()))
        # 上一页
        if self.page > 1:   
            self.query_dict.setlist(self.page_param, [self.page - 1])
            prev = '<li><a href="?{}">上一页</a></li>'.format(self.query_dict.urlencode())
        else:
            self.query_dict.setlist(self.page_param, [1])
            prev = '<li><a href="?{}">上一页</a></li>'.format(self.query_dict.urlencode())
        page_str_list.append(prev)
        # 页码
        for i in range(start_page, end_page + 1):
            self.query_dict.setlist(self.page_param, [i])
            if i == self.page:
                ele = '<li class="active"><a href="?{}">{}</a></li>'.format(self.query_dict.urlencode(),i)
            else:
                ele = '<li><a href="?{}">{}</a></li>'.format(self.query_dict.urlencode(),i)
            page_str_list.append(ele)
        # 下一页
        if self.page < end_page:
            self.query_dict.setlist(self.page_param, [self.page + 1])
            prev = '<li><a href="?{}">下一页</a></li>'.format(self.query_dict.urlencode())
        else:
            self.query_dict.setlist(self.page_param, [self.total_page_count])
            prev = '<li><a href="?{}">下一页</a></li>'.format(self.query_dict.urlencode())
        page_str_list.append(prev)
        # 尾页
        self.query_dict.setlist(self.page_param, [self.total_page_count])
        page_str_list.append('<li><a href="?{}">尾页</a></li>'.format(self.query_dict.urlencode()))

        # 页码搜索框
        search_string = """
            <li>
                <form style="float: left;margin-left: -1px;" method="get">
                    <input type="text" name="page" class="form-control" placeholder="页码"
                    style="position:relative;float:left;display:inline-block;width: 80px;border-radius:0;" >
                    <button style="border-radius: 0;" class="btn btn-default" type="submit">跳转</button>
                </form>
            </li>
        """
        page_str_list.append(search_string)

        page_string = mark_safe("".join(page_str_list))

        return page_string


```

## 时间选择组件

登录下载：https://gitee.com/mirrors/bootstrap-datepicker

```html
{% load static %}

{% block css %}
    <link rel="stylesheet" href="{% static 'plugins/bootstrap-datepicker/css/bootstrap-datepicker.min.css' %}">
{% endblock %}

<!-- 在入职时间的input框内加入 id="dt" -->

{% block js %}
    <script src="{% static 'plugins/bootstrap-datepicker/js/bootstrap-datepicker.js' %}"></script>
    <script src="{% static 'plugins/bootstrap-datepicker/locales/bootstrap-datepicker.zh-CN.min.js' %}"></script>
    <script>
        $(function(){
            $('#dt').datepicker({
                format: 'yyyy-mm-dd',
                startDate: '0',
                language: "zh-CN",
                autoclose: true
            });
        })
    </script>
{% endblock %}

/* ModelForm在生成标签时，会自动加上一个id="id_字段名" */
```

## ModelForm和BootStrap

ModelForm可以帮我们生成HTML标签

```python
class UserModelForm(forms.ModelForm):
    class Meta:
        model = models.UserInfo
        fields = ["name","password"]

form = UserModelForm()
```

```
{{form.name}}		普通的input框
{{form.password}}
```

- 修饰input框：定义插件

  ```python
  class UserModelForm(forms.ModelForm):
      class Meta:
          model = models.UserInfo
          fields = ["name","password"]
          widgets = {
              "name": forms.TextInput(attrs={"class": "form-control"}),
              "password": forms.TextInput(attrs={"class": "form-control"}),
          }
  ```

  ```python
  class UserModelForm(forms.ModelForm):
      name = forms.CharField(
      	min_length = 3,
          label = "用户名",
          widget = forms.TextInput(attrs={"class": "form-control"})
      )
      
      class Meta:
          model = models.UserInfo
          fields = ["name","password"]
  ```

- 上面太繁琐了-->重新定义init方法

  ```python
  class UserModelForm(forms.ModelForm):
      class Meta:
              model = models.UserInfo
              fields = ["name","password"]
  
      def __init__(self,*args,**kwargs):
              super().__init__(*args,**kwargs)
          
          # 循环ModelForm中的所有字段，给每个字段的插件设置
          for name, field in self.fields.items():     
              field.widget.attrs = {
                  "class": "form-control", 
                  "placeholder":field.label
              }	# 这里是直接硬性设置了，设死了
  ```

  - 优化

    ```python
    class UserModelForm(forms.ModelForm):
        class Meta:
                model = models.UserInfo
                fields = ["name","password"]
    
        def __init__(self,*args,**kwargs):
                super().__init__(*args,**kwargs)
            
            # 循环ModelForm中的所有字段，给每个字段的插件设置
            for name, field in self.fields.items(): 
                
                # 字段中这些有属性，保留原来的属性就改值；没有属性，才增加
                if field.widget.attrs:
                    field.widget.attrs["class"] = "form-control"
                    field.widget.attrs["placeholder"] = field.label
                else:
                    field.widget.attrs = {
                        "class": "form-control", 
                        "placeholder":field.label
                    }
    ```

    - 缺点：每次要应用一个新的ModelForm时，这种代码都得重复写一遍，麻烦

      优化：自定义一个类，利用ModelForm的继承，想用这个功能的类就继承它

    ```python
    class BootStrapModelForm(forms.ModelForm):
        def __init__(self,*args,**kwargs):
                super().__init__(*args,**kwargs)
            # 循环ModelForm中的所有字段，给每个字段的插件设置
            for name, field in self.fields.items():    
                # 字段中这些有属性，保留原来的属性就改值；没有属性，才增加
                if field.widget.attrs:
                    field.widget.attrs["class"] = "form-control"
                    field.widget.attrs["placeholder"] = field.label
                else:
                    field.widget.attrs = {
                        "class": "form-control", 
                        "placeholder":field.label
                    }
                    
    
    class UserModelForm(BootStrapModelForm):	# 继承之后省了上面那串代码
        class Meta:
                model = models.UserInfo
                fields = ["name","password"]                                
    ```

  - 搬迁Form



## 管理员



## 登录

登陆成功后：

- cookies，随机字符串

- session，用户信息

- 在其他需要登陆才能访问的页面中，都需要加入：

  ```python
  def index(request):
  	info = request.session.get("info")
  	in not info:
  		return redirect('/login/')
  	...
  ```

  目标：在18个视图函数前面统一加入判断

  ## 中间件

- 定义中间件
- 注册中间件，然后就可以应用了
- 在中间件的 process_requset 方法
  - 如果方法中没有返回值（返回None），继续向后走
  - 如果有返回值，例：HttpResponse、render，则不再继续
- 中间件的 process_response

## 中间件实现登录校验

- 编写中间件

  ```python
  from django.shortcuts import redirect
  from django.utils.deprecation import MiddlewareMixin
  
  class AuthMiddleware(MiddlewareMixin):
      """中间件1"""
      
      def process_requset(self, request):
          # 0. 排除不需要登录就能访问的页面
          # request.path_info：获取当前用户请求的url  /login/
          if request.path_info == "/login/":
              return 
  
          # 1.读取当前访问的用户的session信息，能读到则用户已登录过，继续向后走
          info_dict = request.session.get("info")
          if info_dict:
              return
          
          # 2.没有登陆过，回到登陆页面
          return redirect("/login/")
  
  ```

  

- 应用中间件

## 图片验证码

生成图片

```
pip install pillow

下载字体文件  Monaco.ttf		http://xiazaiziti.com/250657.html  放在总目录下
```

校验验证码

## Ajax请求

浏览器向网站发送请求时：	URL和表单的形式提交

- get
- post

特点：页面刷新

除此之外，也可以基于Ajax向后台发送请求（偷偷的发送）

- 依赖jQuery

- 编写ajax代码

  ```js
  $.ajax({
  	url:"发送的地址",
  	type:"post",
  	data:{
  		n1:123,
  		n2:345
  	},
  	success:function(res){
  	console.log(res);
  	}
  })
  ```

  GET请求

  ```js
  <script type="text/javascript">
  	function clickMe(){
  		$.ajax({
  			url: '/task/ajax/',
  			type:"get",
  			data: {
  			n1:123,
  			n2:456
  			},
  			success:function(res){
  			console.log(res);
  		 }
        })
      }
  </script>
  ```

  ```python
  from django.shortcuts import render, HttpResponse
  def task_ajax(request):
      print(request.GET)
      return HttpResponse("成功了")
  ```

  POST请求

  ```js
  <script type="text/javascript">
  	function clickMe(){
  		$.ajax({
  			url: '/task/ajax/',
  			type:"post",
  			data: {
  			n1:123,
  			n2:456
  			},
  			success:function(res){
  			console.log(res);
  		 }
        })
      }
  </script>
  ```

  ```python
  from django.shortcuts import render, HttpResponse
  from django.views.decorators.csrf import csrf_exempt
  
  @csrf_exempt    # 发送post请求时，可以免除csrf认证
  def task_ajax(request):
      print(request.GET)
      return HttpResponse("成功了")
  ```

  绑定事件

  ```js
      $(function () {
          // 页面框架加载完成之后代码自动执行
          bindBtn1Event();
  
      })
      function bindBtn1Event() {
          $("#btn1").click(function () {
              $.ajax({
                  url: '/task/ajax/',
                  type: "post",
                  data: {
                      n1: 123,
                      n2: 456
                  },
                  success: function (res) {
                      console.log(res);
                  }
              })
          })
      }
  ```

  ajax请求的返回值：一般都会返回JSON格式

  ```js
  {% block js %}
  <script type="text/javascript">
      $(function () {
          // 页面框架加载完成之后代码自动执行
          bindBtn1Event();
  
      })
      function bindBtn1Event() {
          $("#btn1").click(function () {
              $.ajax({
                  url: '/task/ajax/',
                  type: "post",
                  data: {
                      n1: 123,
                      n2: 456
                  },
                  dataType:"JSON",
                  success: function (res) {
                      console.log(res);
                      console.log(res.status);
                      console.log(res.data);
                  }
              })
          })
      }
  </script>
  {% endblock %}
  ```

  ```python
  # task.py
  import json
  from django.shortcuts import render, HttpResponse
  from django.http import JsonResponse
  from django.views.decorators.csrf import csrf_exempt
  
  
  def task_list(request):
      """任务列表"""
      return render(request, "task_list.html")
  
  @csrf_exempt    # 发送post请求时，可以免除csrf认证
  def task_ajax(request):
      print(request.GET)
      print(request.POST)
      data_dict = {"status":True, 'data':[11,22,33,44]}
      return HttpResponse(json.dumps(data_dict))
  
      # return JsonResponse(data_dict)    一样的
  ```

上传文件

```html
<form method="post" enctype="multipart/form-data">
        {% csrf_token %}
        <input type="text" name="username">
        <input type="file" name="avatar">
        <input type="submit" value="提交">
    </form>

request.POST	// 表单信息
request.FILES	// 上传文件
```

```python
from django.shortcuts import render,HttpResponse


def upload_list(request):
    if request.method == "GET":
        return render(request, 'upload_list.html')

    
    file_object = request.FILES.get("avatar")
    f = open(file_object.name, mode='wb')
    for chunk in file_object.chunks():
        f.write(chunk)
    f.close()
    return HttpResponse("上传完毕")
```



# 参考项目

```
https://github.com/spray-dream/EmpSystem 
```



# 附加

## 国内下载源网站 :

使用方法：pip install xxx -i '网址'  (--target=指定目录完整路径 )

清华：https://pypi.tuna.tsinghua.edu.cn/simple

阿里云：http://mirrors.aliyun.com/pypi/simple/

中国科技大学： https://pypi.mirrors.ustc.edu.cn/simple/

华中理工大学：http://pypi.hustunique.com/

山东理工大学：http://pypi.sdutlinux.org/

豆瓣：http://pypi.douban.com/simple/ 









